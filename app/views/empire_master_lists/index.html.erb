<p id="notice"><%= notice %></p>

<div class="well">
  <h1 class="text-center">Empire Master Lists</h1>
</div>


<h3>Upload CSV File</h3>
  <%= form_tag import_empire_master_lists_path, multipart: true do %>
  <%= file_field_tag :file %>
<br>
  <%= submit_tag 'Upload', class: 'btn btn-primary' %>
<% end %>
<br>

<% if params['confirm'] == 'yes' %>
  <% EmpireMasterList.where(source: params['delete']).delete_all %>
  <% redirect_to empire_master_lists_path(done: 'yes') %>
<% end %>

<div class="row">
  <div class="col-md-3">
    <table class="table table-outline">
      <thead>
        <tr>
          <th>State</th>
          <th>List</th>
          <th>Count</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>CA</td>
          <td><%= @ca.uniq.join %></td>
          <td><%=  number_with_delimiter(@ca.count) %></td>
          <% if params['delete'] == 'CA' %>
            <td><%= link_to 'Confirm', empire_master_lists_path(delete: 'CA', confirm: 'yes') %></td>
          <% elsif %>
            <td><%= link_to 'Delete', empire_master_lists_path(delete: 'CA') %></td>
          <% end %>
        </tr>
        <tr>
          <td>NY</td>
          <td><%= @ny.uniq.join %></td>
          <td><%=  number_with_delimiter(@ny.count) %></td>
          <% if params['delete'] == 'NY' %>
            <td><%= link_to 'Confirm', empire_master_lists_path(delete: 'NY', confirm: 'yes') %></td>
          <% elsif %>
            <td><%= link_to 'Delete', empire_master_lists_path(delete: 'NY') %></td>
          <% end %>
        </tr>
        <tr>
          <td>NM</td>
          <td><%= @nm.uniq.join %></td>
          <td><%=  number_with_delimiter(@nm.count) %></td>
          <% if params['delete'] == 'NM' %>
            <td><%= link_to 'Confirm', empire_master_lists_path(delete: 'NM', confirm: 'yes') %></td>
          <% elsif %>
            <td><%= link_to 'Delete', empire_master_lists_path(delete: 'NM') %></td>
          <% end %>
        </tr>
        <tr>
          <td>UT</td>
          <td><%= @ut.uniq.join %></td>
          <td><%= number_with_delimiter(@ut.count) %></td>
          <% if params['delete'] == 'UT' %>
            <td><%= link_to 'Confirm', empire_master_lists_path(delete: 'UT', confirm: 'yes') %></td>
          <% elsif %>
            <td><%= link_to 'Delete', empire_master_lists_path(delete: 'UT') %></td>
          <% end %>
        </tr>
        <tr>
          <td>WA</td>
          <td><%= @wa.uniq.join %></td>
          <td><%= number_with_delimiter(@wa.count) %></td>
          <% if params['delete'] == 'WA' %>
            <td><%= link_to 'Confirm', empire_master_lists_path(delete: 'WA', confirm: 'yes') %></td>
          <% elsif %>
            <td><%= link_to 'Delete', empire_master_lists_path(delete: 'WA') %></td>
          <% end %>
        </tr>
        <tr>
          <td>MO_B</td>
          <td><%= @mo_b.uniq.join %></td>
          <td><%= number_with_delimiter(@mo_b.count) %></td>
          <% if params['delete'] == 'MO_B' %>
            <td><%= link_to 'Confirm', empire_master_lists_path(delete: 'MO_B', confirm: 'yes') %></td>
          <% elsif %>
            <td><%= link_to 'Delete', empire_master_lists_path(delete: 'MO_B') %></td>
          <% end %>
        </tr>

        <%# @states.each do |k,v| %>
        <!-- <tr> -->
          <!-- <td><%#= k %></td> -->
          <!-- <td><%#= number_with_delimiter(v.count) %></td> -->
        <!-- </tr> -->
        <%# end %>
      </tbody>
    </table>
  </div>
</div>
