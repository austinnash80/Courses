<body class= 'body-home'>

<% if user_signed_in? && current_user.superadmin_role?%>

  <% if user_signed_in? && current_user.email == 'austin@sequoiacpe.com' %>
    <h1 class="off-white text-center">Austin Dashboard</h1>
    <h3 class="off-white text-center"><%= Date.today.strftime('%A %-b %-d, %Y') %></h3>
  <% end %>

</br>

<!-- START LEFT COLUMN -->
<div class="col-lg-4">
    <div class="well">
        <%= render(:partial => 'msi_mailing') %>
    </div>

    <div class="well">
        <%= render(:partial => 'task') %>
    </div>
</div>
<!-- END LEFT COLUMN -->


<div class="col-lg-4">
  <div class="well">
<!-- Tabs Start -->
    <ul class="nav nav-tabs">
      <li class="active"><a data-toggle="tab" href="#home1">Home</a></li>
      <li><a data-toggle="tab" href="#menu1">Postcard Inventory</a></li>
    </ul>
<!-- Tab 1 Start -->
    <div class="tab-content">
      <div id="home1" class="tab-pane fade in active">
        <h3>HOME</h3>

        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Task </th>
              <th>Status </th>
              <th>Note </th>
            </tr>
          </thead>
          <tbody>
            <% @tasks.each do |task| %>
            <% if task.user_1 == @name || task.user_2 == @name || task.user_3 == @name || task.user_4 == @name || task.user_5 == @name %>
              <% if task.done == false && task.due == true && task.type_one == true && Date.today >= (task.due_date - 5) %>
            <tr>
              <td><%= task.title.truncate_words(4) %></td>
              <% if Date.today > task.due_date %>
                <td><strong> Past Due: <%= task.due_date.strftime('%-m/%-d') %></strong></td>
              <% elsif %>
                <td><strong> Due: <%= task.due_date.strftime('%a (%-m/%-d)') %></strong></td>
              <% end %>
              <Td> <%= link_to 'View Task', task %></td>
            </tr>
              <% end %>
            <% end %>
            <% end %>
            <tr>
              <td>Course Updating</td>
              <% if @course_update_status.sum == 0 && @course_update_status_proofing.sum == 0 %>
                <td class="green">Nothing in-progress</td>
                <td> <%= link_to 'Add Update', datasheets_path %></td>
              <% elsif @course_update_status.sum == 0 && @course_update_status_proofing.sum != 0 %>
                <td>Proofing Needed</td>
                <td><%= link_to @course_update_status_proofing.sum, updatesheets_path %> <%= link_to 'Not Proofed', updatesheets_path %> | <%= link_to 'Add Update', datasheets_path %></td>
              <% elsif @course_update_status.sum != 0 && @course_update_status_proofing.sum == 0%>
                <td class="red"><%= @course_update_status.sum %> In-progress</td>
                <td><%= link_to 'Updatesheet', updatesheets_path %> | <%= link_to 'Add Update', datasheets_path %></td>
              <% elsif @course_update_status.sum != 0 && @course_update_status_proofing.sum != 0%>
                <td class="red"><%= @course_update_status.sum %> In-progress | <%= @course_update_status_proofing.sum %> Proofing</td>
                <td><%= link_to 'Updatesheet', updatesheets_path %> | <%= link_to 'Add Update', datasheets_path %></td>
              <% end %>
            </tr>
            <tr>
              <td>MSI Mailing</td>
              <% if (Date.today) > (@next_msi_mailing.min - 8) %>
                <td class="red">Mailing Due Now</td>
              <% elsif %>
                <td> Mailing due in <%= ((@next_msi_mailing.min - 8) - Date.today).to_i %> Days</td>
              <% end %>
              <% if (Date.today) > (@art_missing.min - 18) %>
                <td class="red">Behind on art</td>
              <% elsif %>
                <td class="">No art due yet (<%= ((@art_missing.min - 18) - Date.today).to_i %> Days) </td>
              <% end%>
            </tr>
            <tr>
              <td>Postcard Inventory</td>
              <% if @remaining_inventory.min >= 500%>
                <td class="green">Good</td>
                <td><a data-toggle="tab" href="#menu1">Inventory</a></td>
              <% elsif %>
                <td class="red">Low</td>
                <td> <strong><a data-toggle="tab" href="#menu1">Check Inventory</a></strong> </td>
              <% end %>
            </tr>

            <tr>
              <td>Texas Royalties Check </td>
              <% if Date.today > (@next_due.min.to_date + 5) %>
                <td class="red">Over Due (<%= (@next_due.min.to_date + 5).strftime('%-m/%-d/%y') %>)</td>
              <% elsif %>
                <td>Due: <%= (@next_due.min.to_date + 5).strftime('%-m/%-d/%y') %></td>
              <% end %>
              <td><%= link_to 'Materials', tx_royalties_path %></td>
            </tr>
          </tbody>
        </table>
      </div>
<!-- Tab 1 end -->
<!-- Tab 2 start -->
      <div id="menu1" class="tab-pane fade">
        <h3>Postcard Inventory</h3>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Company</th>
              <th>Version</th>
              <th>Order Date</th>
              <th>Order Amount</th>
              <th>Remaining</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Sequoia</td>
              <td>CPA NM</td>
              <td><%= @date_sequoia_cpa_nm.max.strftime('%-m/%-d/%y') %></td>
              <td><%= @number_sequoia_cpa_nm[0] %></td>
              <% if (@inventory_sequoia_cpa_nm.sum - @used_sequoia_cpa_nm.sum) < 500 %>
                <td class="red"><%= @inventory_sequoia_cpa_nm.sum - @used_sequoia_cpa_nm.sum %></td>
              <% elsif %>
                <td><%= @inventory_sequoia_cpa_nm.sum - @used_sequoia_cpa_nm.sum %></td>
              <% end %>
            </tr>
            <tr>
              <td>Sequoia</td>
              <td>CPA RC</td>
              <td><%= @date_sequoia_cpa_rc.max.strftime('%-m/%-d/%y') %></td>
              <td><%= @number_sequoia_cpa_rc[0] %></td>
              <% if (@inventory_sequoia_cpa_rc.sum - @used_sequoia_cpa_rc.sum) < 500 %>
                <td class="red"><%= @inventory_sequoia_cpa_rc.sum - @used_sequoia_cpa_rc.sum %></td>
              <% elsif %>
                <td><%= @inventory_sequoia_cpa_rc.sum - @used_sequoia_cpa_rc.sum %></td>
              <% end %>
            </tr>
            <tr>
              <td>Sequoia</td>
              <td>EA NM</td>
              <td><%= @date_sequoia_ea_nm.max.strftime('%-m/%-d/%y') %></td>
              <td><%= @number_sequoia_ea_nm[0] %></td>
              <% if (@inventory_sequoia_ea_nm.sum - @used_sequoia_ea_nm.sum) < 500 %>
                <td class="red"><%= @inventory_sequoia_ea_nm.sum - @used_sequoia_ea_nm.sum %></td>
              <% elsif %>
                <td><%= @inventory_sequoia_ea_nm.sum - @used_sequoia_ea_nm.sum %></td>
              <% end %>
            </tr>
            <tr>
              <td>Sequoia</td>
              <td>EA RC</td>
              <td><%= @date_sequoia_ea_rc.max.strftime('%-m/%-d/%y') %></td>
              <td><%= @number_sequoia_ea_rc[0] %></td>
              <% if (@inventory_sequoia_ea_rc.sum - @used_sequoia_ea_rc.sum) < 500 %>
                <td class="red"><%= @inventory_sequoia_ea_rc.sum - @used_sequoia_ea_rc.sum %></td>
              <% elsif %>
                <td><%= @inventory_sequoia_ea_rc.sum - @used_sequoia_ea_rc.sum %></td>
              <% end %>
            </tr>
            <tr>
              <td>Empire</td>
              <td>General RC</td>
              <td><%= @date_empire_rc.max.strftime('%-m/%-d/%y') %></td>
              <td><%= @number_empire_rc[0] %></td>
              <% if (@inventory_empire_rc.sum - @used_empire_rc.sum) < 500 %>
                <td class="red"><%= @inventory_empire_rc.sum - @used_empire_rc.sum %></td>
              <% elsif %>
                <td><%= @inventory_empire_rc.sum - @used_empire_rc.sum %></td>
              <% end %>
            </tr>
          </tbody>
        </table>
      </div>
<!-- Tab 2 end -->
    </div>
<!-- Tabs End -->
  </div>
  <div class="well">
<!-- Tabs Start -->
    <ul class="nav nav-tabs">
      <li class="active"><a data-toggle="tab" href="#home2">Home</a></li>
      <li><a data-toggle="tab" href="#menu2">Menu 1</a></li>
    </ul>
<!-- Tab 1 Start -->
    <div class="tab-content">
      <div id="home2" class="tab-pane fade in active">
        <h3>HOME</h3>
        <p>Some content.</p>
      </div>
<!-- Tab 1 end -->
<!-- Tab 2 start -->
      <div id="menu2" class="tab-pane fade">
        <h3>Menu 1</h3>
        <p>Some content in menu 1.</p>
      </div>
<!-- Tab 2 end -->
    </div>
<!-- Tabs End -->
  </div>
</div>

<div class="col-lg-4">

    <div class="well">
        <%= render(:partial => 'sales_day') %>
    </div>


<!-- Start Month -->
    <div class="well">

      <div class="tab-content">

        <div id="monthmenu" class="tab-pane fade in active">
        <h3 class="text-center"> Sequoia MTD: <%= number_to_currency(@total_mtd, :precision => 0) %> </h3>
         <h4 class="text-center"><%= Date.today.strftime('%B %Y') %></h4>
          <div class="row">
          </br>
            <div class="col-lg-6">
            </br>
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th class="text-center" style="width: 33%">CPA </th>
                      <th class="text-center" style="width: 33%">EA </th>
                      <th class="text-center" style="width: 33%">AFSP </th>
                    </tr>
                  </thead>
                  <tbody>
                   <tr class="text-center">
                     <td> <%= number_to_currency(@cpa_mtd, :precision => 0) %> </td>
                     <td> <%= number_to_currency(@ea_mtd, :precision => 0) %> </td>
                     <td> <%= number_to_currency(@afsp_mtd, :precision => 0) %> </td>
                    </tr>
                    <tr>
                      <th class="text-center">New</th>
                      <th class="text-center">Return</th>
                      <th class="text-center">Ethics</th>
                    </tr>
                   <tr class="text-center">
                     <td> <%= number_to_currency(@new_mem_mtd, :precision => 0) %> </td>
                     <td> <%= number_to_currency(@return_mem_mtd, :precision => 0) %> </td>
                     <td> <%= number_to_currency(@cpa_ethics_mtd, :precision => 0) %> </td>
                    </tr>
                  </tbody>
                </table>
            </div>
          <div class="well col-lg-6">
            <%= column_chart @column_chart_mtd, prefix: "$", thousands: ",", xtitle: "", ytitle: "", height: '', id: "Month", download: true, title: "" %>
          </div>
        </div>
      </div>

      <div id="yearmenu" class="tab-pane fade in">
        <h3 class="text-center"> Sequoia YTD: <%= number_to_currency(@total_ytd, :precision => 0) %> </h3>
         <h4 class="text-center"><%= Date.today.strftime('%Y') %></h4>
          <div class="row">
          </br>
            <div class=" col-lg-6">
            </br>
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th class="text-center" style="width: 33%">CPA </th>
                      <th class="text-center" style="width: 33%">EA </th>
                      <th class="text-center" style="width: 33%">AFSP </th>
                    </tr>
                  </thead>
                  <tbody>
                   <tr class="text-center">
                     <td> <%= number_to_currency(@cpa_ytd, :precision => 0) %> </td>
                     <td> <%= number_to_currency(@ea_ytd, :precision => 0) %> </td>
                     <td> <%= number_to_currency(@afsp_ytd, :precision => 0) %> </td>
                    </tr>
                    <tr>
                      <th class="text-center">New</th>
                      <th class="text-center">Return</th>
                      <th class="text-center">Ethics</th>
                    </tr>
                   <tr class="text-center">
                     <td> <%= number_to_currency(@new_mem_ytd, :precision => 0) %> </td>
                     <td> <%= number_to_currency(@return_mem_ytd, :precision => 0) %> </td>
                     <td> <%= number_to_currency(@cpa_ethics_ytd, :precision => 0) %> </td>
                    </tr>
                  </tbody>
                </table>
            </div>
          <div class="well col-lg-6">
            <%= column_chart @column_chart_ytd, prefix: "$", thousands: ",", xtitle: "", ytitle: "", height: '', id: "YearChart", download: true, title: "" %>
          </div>
        </div>

    </div>
    </div>
    </div>

<!-- Start Year -->
    <div class="well">
      <h3 class="text-center"> Sequoia YTD: <%= number_to_currency(@total_ytd, :precision => 0) %> </h3>
       <h4 class="text-center"><%= Date.today.strftime('%Y') %></h4>
        <div class="row">
        </br>
          <div class=" col-lg-6">
          </br>
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th class="text-center" style="width: 33%">CPA </th>
                    <th class="text-center" style="width: 33%">EA </th>
                    <th class="text-center" style="width: 33%">AFSP </th>
                  </tr>
                </thead>
                <tbody>
                 <tr class="text-center">
                   <td> <%= number_to_currency(@cpa_ytd, :precision => 0) %> </td>
                   <td> <%= number_to_currency(@ea_ytd, :precision => 0) %> </td>
                   <td> <%= number_to_currency(@afsp_ytd, :precision => 0) %> </td>
                  </tr>
                  <tr>
                    <th class="text-center">New</th>
                    <th class="text-center">Return</th>
                    <th class="text-center">Ethics</th>
                  </tr>
                 <tr class="text-center">
                   <td> <%= number_to_currency(@new_mem_ytd, :precision => 0) %> </td>
                   <td> <%= number_to_currency(@return_mem_ytd, :precision => 0) %> </td>
                   <td> <%= number_to_currency(@cpa_ethics_ytd, :precision => 0) %> </td>
                  </tr>
                </tbody>
              </table>
          </div>
        <div class="well col-lg-6">
          <%= column_chart @column_chart_ytd, prefix: "$", thousands: ",", xtitle: "", ytitle: "", height: '', id: "Year", download: true, title: "" %>
        </div>
      </div>
    </div>

  </div>

<% end %>



</body>
